# Пример использования API на C#

Полная документация API https://wiki.logistpro.su/display/LKB/LogistPro+API

Пример организован в виде проекта [MSTest для .Net Core](https://docs.microsoft.com/en-us/dotnet/core/testing/unit-testing-with-mstest).

## Запуск примера
Для запуска примера, необходимо:
1. установить [.Net Core 2.1](https://dotnet.microsoft.com/download/dotnet-core/2.1) для Windows, Linux или macOS
2. заполнить необходимые константы в файле [ApiExample.cs](ApiExample.cs)
	- базовые настройки доступа (актуализировать базовые настройки можно в [Wiki](https://wiki.logistpro.su/display/LKB/LogistPro+API) проекта)
	```c#
	// базовые настройки доступа
	private const string API_BASE_HOST = "https://...";
	private const string API_BASE_URL = API_BASE_HOST + "/api/v1/";
	```
	- API ключ личного кабинета компании (запросить ключ можно обратившись в [Службу поддержки](https://jira.logistpro.su/servicedesk/customer/portal/4) или написав заявку по адресу support@logistpro.su)
	```c#
	// API ключ личного кабинета компании
	private const string API_KEY = "...";
	```
	- логин/пароль технического аккаунта (можно использовать любой логин/пароль пользователя из личного кабинета компании)
	```c#
	// логин/пароль технического аккаунта с максимальными правами доступа
	private const string LOGIN = "...";
	private const string PASSWORD = "...";
	```
3. запустить сборку и тестирование командой
	```
	dotnet test
	```

## Сценарий примера
Сценарий реализован в виде последовательности запросов к API, реализующих функции создания и контроля статуса заказа.

0. Настройка передачи API ключа в заголовках HTTP запросов
1. Проверка доступности API
2. Авторизация заданным пользователем
	- получение авторизационной куки
	- настройка передачи авторизации в заголовках HTTP запросов
3. Получение справочников с сервера
4. Создание запроса на транспорт (с датой исполнения +7 дней вперед)
5. Проверка статуса созданного запроса с получением дополнительной информации:
	- Статус с расшифровкой
	- Количество предложений
	- Текущее лучшее предложение
6. Получение идентификатора подрядчика с сервера
7. Создание нового запроса с прямым назначением перевозки на выбранного подрядчика
8. Проверка статуса согласования перевозки
